% 得られた知見について
\section{形式化するにあたって}
今回，Coq + SSReflect を用いて三角形三色問題の証明の形式化を完成させることができた．ここでは，形式化を完成させるにあたって経験したことや得られた知見について述べる．

$1$つ目として挙げるのは，形式化をする際には，形式化する方針をしっかりと考え，計画を立ててから実装するべきである．なぜなら，形式化の方針によっては Coq で実装するコードの行数を抑えられるからである．実際，$2021$ 年 $9$ 月に公開していたコードは約 $1200$ 行であったが，形式化の方針を変えて新しく $2021$ 年 $10$ 月で公開した三角形三色問題のコード
\footnote{
  \ref{sec:start}章でも述べたが，
  \url{https://github.com/SyotaHashimoto/ThreeColor} から
  完成させたCoqのコード (``Coqによる三角形三色問題の証明.v'') を
  ダウンロードすることができる．
}
は約 $900$ 行となり約 $300$ 行も減らすことができた．$9$ 月に公開していたコードでの実装では，述語を用いた命題や主張で実装をしていた．例えば，左から $x$ 番目，上から $y$ 番目のマスに塗られている色は $c$ であることを述語 $Cpos(x,y,c)$ とし，この述語が表す内容を公理を用いて定めることで命題や主張を表していた．一方で，新しく $10$ 月に公開したコードでは述語 $Cpos(x,y,c)$ ではなく，$\cpos$ や $\lift$ といった関数を用いて書き直すことができた．また，今回のように述語ではなく関数を用いて形式化すると，実装するコードの行数を大幅に削減できるだけでなく，公理を用意する必要がなくなるというメリットもあることもわかった．これは公理でマスに塗られる色は$1$色のみ存在することを保証していたが，関数に書き直すことで一意性を常に満たすからである．

$2$つ目としては，SSReflect を用いる際にはできる限り bool 型で実装することである．SSReflect には命題や主張をブール型と見なすことで証明を支援する機能が備わっている．そのため，SSReflect を用いる際には Prop 型ではなく bool 型として実装することで，様々な SSReflect の恩恵をうけることができる．例えば，bool 型で書かれた命題や主張はタクティック rewrite を用いることで真理値を計算したり，変形することで容易に証明することができる．
また，関数を定義する際に if 文を用いることがあるが，if 文の条件部分は bool 型を要求する．こういった側面からも Prop 型ではなく bool 型で実装した方が良いと考えられる．

一方で，$\forall$，$\exists$ が入った論理式は bool 型になおすことが困難であるため，今回の形式化を完成させる際に用いた $\Fmix$ は bool 型になおすことができなかった．したがって，$\WCTF$ は $\Fmix$ を含むので bool 型になおすことができず，形式化するにあたって用いたすべての主張や命題を bool 型を書き直すことができなかった．もし，この問題が解決することができたときには，更に形式化を完成させるためのコードを減らすことができるのではないかと考えられる．



%% 目標：これで得られた知見をまとめる (読者との情報共有)
%% - 形式化の最初の方針が肝心．上手い選択をすると証明の行数が大幅に削減できる
%% - 述語はやめる．関数で書けるならそっちの方がよい．
%% --- 自然と rewrite を使うことになるので ssreflect の利点を生かすことになる．
%% - できることなら Prop でなく bool で統一した方が ssreflect の利点が生きる
%% --- 関数定義をする際に if 文を用いると条件は bool 型を要求されるため，
%% --- 条件部分の述語は Prop 型でなく bool 型で最初から定義するとよい
%% -- forall や exists が入った論理式は無理そう
%% -- この理由により F_mix は bool にはできなかった
%% -- WellColoredTriangleF は F_mix を含むので bool にできなかった
%% - 紙に証明を書いてから実装するべし
%% -- 証明の設計は大事．全体の方針が見えるように上手く補題を立てるべし
