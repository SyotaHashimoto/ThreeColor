\documentclass[dvipdfmx,cjk]{beamer}
\usepackage{mymacro}
\usepackage[all]{xy}
\usepackage{tikz,here,mathdots} % 図・コード
\usetikzlibrary{intersections,calc,arrows.meta,positioning}

\AtBeginDvi{\special{pdf:tounicode 90ms-RKSJ-UCS2}}
\AtBeginDvi{\special{pdf:tounicode EUC-UCS2}}

\setbeamertemplate{navigation symbols}{} %% 右下のアイコンを消す

%フレーム
%\usetheme{CambridgeUS}
%\usetheme{Boadilla}
\usetheme{Madrid}
%\usetheme{Antibes}
%\usetheme{Montpellier}
%\usetheme{Berkeley}
%\usetheme{Goettingen}
%\usetheme{Singapore}
%\usetheme{Szeged}

%色，フォント，内枠，外枠
%\usecolortheme{rose}
%\usecolortheme{albatross}
%\useoutertheme{shadow}                
\usefonttheme{professionalfonts}

%オプション
%\setbeamercovered{transparent}         %% 消えている文字をうっすらと表示する
\setbeamertemplate{theorems}[numbered] %% theorem 環境の冒頭に番号をつける

% 定理環境
\newtheorem{dfn}{定義}[section]
\newtheorem{thm}[dfn]{定理}
\newtheorem{exm}[dfn]{例}
\newcommand{\redt}[1]{\textcolor{red}{#1}}
\newcommand{\blut}[1]{\textcolor{blue}{#1}}
\renewcommand{\proofname}{証明}

% マクロ
\def\Color{\textit{Color}}
\def\mix{\textit{mix}}
\def\red{\textit{red}}
\def\blu{\textit{blu}}
\def\yel{\textit{yel}}
\def\mix{\textit{mix}}
\def\colorYB{\textit{colorYB}}
\def\colorBYB{\textit{colorBYB}}
\def\colorYBBY{\textit{colorYBBY}}
\def\Cpos{\textit{Cpos}}
\def\WCT{\textit{WellColoredTriangle}}
\def\mixCut{\textit{mixCut}}
\def\AllRed{\textit{AllRed}}
\def\falseColor{\textit{falseColor}}
\def\Cexists{\textit{C\_exists}}
\def\Cuniq{\textit{C\_uniq}}
\def\Cmix{\textit{C\_mix}}
\def\Cpaint{\textit{C\_paint}}
\def\EvenA{\textit{EvenA}}
\def\EvenB{\textit{EvenB}}
\def\Even{\textit{Even}}
\def\ShortOddA{\textit{ShortOddA}}
\def\ShortOddB{\textit{ShortOddB}}
\def\ShortOddC{\textit{ShortOddC}}
\def\ShortOdd{\textit{ShortOdd}}
\def\LongOddA{\textit{LongOddA}}
\def\LongOddB{\textit{LongOddB}}
\def\LongOddC{\textit{LongOddC}}
\def\LongOdd{\textit{LongOdd}}

\begin{document}
\title[Coqによる三角形三色問題の証明]{Coqによる三角形三色問題の証明} 
\author[橋本翔太 \and 木村大輔]{\underline{橋本 翔太} \and 木村 大輔 }
\subject{\footnotesize{日本ソフトウェア科学会第$38$回}}
\institute[東邦大学大学院]{東邦大学大学院理学研究科}
\date[2021年9月1日]{2021年9月1日} %September 1st,2021

% タイトルページ
\begin{frame}
  \titlepage
  \begin{center}
    {\small{日本ソフトウェア科学会第$38$回大会}}
  \end{center}
\end{frame}

% 目次
\begin{frame}
  \tableofcontents
\end{frame}

% 本編
\section{研究の背景・概要}

\large
\begin{frame}
  \frametitle{研究の背景}
  Coq \\
  \begin{itemize}
  \item
    人間と対話的に証明を完成させることのできる定理証明支援系
  \end{itemize}
  \vfill
  三角形三色問題
  \begin{itemize}
    \item
    規則に従って塗り分けられた三角形に配置されたマスに
    関する問題
    \item
      『数学セミナー』にて出題（証明済）
      \vfill
    \begin{center}
      \begin{tabular}{ccc}
        \input{wellcolored}
        &
        \hfill
        &
        \input{nine_steps}
        \\
        色塗り規則
        &
        \hfill
        &
        色の塗られた三角形
      \end{tabular}
    \end{center}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{研究の背景}
  \begin{block}{調和性}
    $3$つのマスに塗られている色がすべて同じか相異なるとき，
    この$3$マスは調和しているという.
  \end{block}
  \[
  \begin{tabular}{ccc}
      \input{wellcolored}
      &
      \hfill
      &
      \input{notwellcolored}
      \\
      調和性を満たす
      &
      \hfill
      &
      調和性を満たさない
  \end{tabular}
  \]
  \begin{block}{調和彩色三角形}
    $3$つの端点のマスに塗られている色が調和性を満たしている三色三角形を
    調和彩色三角形 $(Well$-$Colored$ $Triangle)$ という.
  \end{block}
  \vfill
\end{frame}

\normalsize
\begin{frame}
  \frametitle{研究の背景}
  %三角形三色問題 $\cdots$ $3$色を用いて
  %規則に従って逆三角形に配置されたマスを塗り分けた図形に関する問題
  \begin{block}{三角形三色問題（数学セミナー）}
    最上段のマスのどのような塗り方に対しても
    調和彩色三角形になる段数 $n$ を求めよ．
    \\
    \textbf{［解答］}$n=3^k$のとき（証明済）
  \end{block}
  \[
  \begin{tabular}{ccc}
      \input{nine_steps}
      &
      \input{four_steps}
      \\
      段数$n=9$
      &
      段数$n=4$
  \end{tabular}
  \]
  \vfill
\end{frame}

\begin{frame}
  \frametitle{研究の概要}
  \begin{block}{研究の成果}
    $\forall k, n, x, y \in \N, n > 0 \Rightarrow$
    $(n = 3 ^ k \Leftrightarrow \forall c_0, c_1, c_2 \in \Color,\WCT(x,y,n,c_0,c_1,$ $c_2))$ \\
    を Coq で証明した．
  \end{block}
  
  % どうしておこなったのかを解答を用意しておく
  \vfill
  \begin{alertblock}{問題であった点}
    \begin{itemize}
    \item
      幾何的な問題をどのようにして形式化するか
    \item
      暗黙のうちに仮定されてしまっていることを見落としやすい
    \end{itemize}
  \end{alertblock}
  \vfill
  \textbf{［解決法・工夫点］}
  \begin{itemize}
  \item
    三角形三色問題の暗黙の前提を明確化し，
    幾何的な状況を論理式で表現することで公理化した．
  \end{itemize}
\end{frame}

\section{定義と公理}

\begin{frame}
  \frametitle{定義}
  \begin{block}{$\Color$}
    マスに塗る色の集合を次のように定義する．
    \[
    \Color \eqDef \{\red, \yel, \blu\}
    \]
  \end{block}
  \begin{block}{$\Cpos(x,y,c)$}
    左から $x$ 番目，上から $y$ 段目のマスに塗られている色が $c$ である.
  \end{block}
  \vfill
  \begin{minipage}{0.45\hsize}
  \[
  \input{nine_steps}
  \]
  \end{minipage}
  \begin{minipage}{0.45\hsize}
    左の調和彩色三角形において，
    \begin{itemize}
    \item
      $\Cpos(0, 0, \yel)$
    \item
      $\Cpos(9, 0, \blu)$
    \item
      $\Cpos(0, 9, \red)$
    \end{itemize}
    \hfill
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{定義とその性質}
  {\footnotesize
  \begin{block}{$\mix(c_0,c_1)$}
    $\mix$ $:$ $(\Color \times \Color )$ $\to$ $Color$ を以下で定義．
    \begin{center}
    \begin{tabular}{ccccc}
      $(\red,\red) \Pto \red,$ & $(\red,\yel) \Pto \blu,$ & $(\red,\blu) \Pto \yel,$ \\
      $(\yel,\red) \Pto \blu,$ & $(\yel,\yel) \Pto \yel,$ & $(\yel,\blu) \Pto \red,$ \\
      $(\blu,\red) \Pto \yel,$ & $(\blu,\yel) \Pto \red,$ & $(\blu,\blu) \Pto \blu.$ \\
    \end{tabular}
    \end{center}
  \end{block}
  \begin{exampleblock}{$\mixCut$（$\mix$の性質）}
    $\forall c_0, c_1, c_2, c_3 \in Color,$ \\
    $\mix( \mix ( \mix(c_0,c_1) , \mix(c_1,c_2) ), \mix( \mix(c_1 c_2),$
    $\mix(c_2,c_3) ) )$ $=$ $\mix(c_0,c_3)$.
  \end{exampleblock}
  \[
  \xymatrix@R=5pt@C=10pt{
    \text{（左辺）} \ar@{-}[r] \ar@{-}[rdd]
    &
    \mix ( \mix(c_0,c_1) , \mix(c_1,c_2) ) \ar@{-}[r] \ar@{-}[rd]
    &
    \mix(c_0,c_1) \ar@{-}[r] \ar@{-}[rd]
    &
    c_0
    \\
    &
    &
    \mix(c_1,c_2) \ar@{-}[r] \ar@{-}[rd]
    &
    c_1
    \\
    &
    \mix( \mix(c_1,c_2), \mix(c_2,c_3) ) ) \ar@{-}[r] \ar@{-}[rd]
    &
    \mix(c_1,c_2) \ar@{-}[r] \ar@{-}[ru]
    &
    c_2
    \\
    &
    &
    \mix(c_2,c_3) \ar@{-}[r] \ar@{-}[ru]
    &
    c_3
  }
  \]
  }
\end{frame}

\begin{frame}
  \frametitle{定義}
  \begin{block}{$\WCT(x, y, n, c_0,$ $c_1, c_2)$}
    {\small{
        \WCT$(x, y, n, c_0, c_1, c_2)$ $\iffDef$ \\
        $(\Cpos(x,y,c_0)$ $\land$ $\Cpos(x+n,y,c_1)$ $\land$ $\Cpos(x,y+n,c_2))$ $\Imp$ $c_2 = \mix(c_0,c_1)$.
      }
    }
  \end{block}
  $c^x_y$：左から$x$個目，上から$y$段目のマスに塗られている色
  \[
  \input{nine_steps2}
  \]
\end{frame}

\begin{frame}
  \frametitle{公理}
  \begin{block}{$\Cexists$}
    $\forall x, y \in \N, \exists c \in \Color, \Cpos(x,y,c).$
  \end{block}
  \begin{itemize}
  \item
    すべてのマスには何かしらの色が塗られている．
  \end{itemize}
  \vfill
  \begin{block}{$\Cmix$}
    $\forall x, y \in \N, \forall. c \in \Color,$ \\
    {\small
      $(\Cpos(x,y,c_0)$ $\land$ $\Cpos(x+1,y,c_1)$ $\land$ $\Cpos(x,y+1,c_2))$ $\Imp$ $c_2 = \mix(c_0,c_1)$.
    }
  \end{block}
  \begin{itemize}
  \item
    色塗り規則に従って塗られている．
  \end{itemize}
  \begin{center}
    \input{wellcolored2}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{公理}
  \begin{block}{$\Cuniq$}
    $\forall x, y \in \N, \forall c_0, c_1 \in \Color,$ 
    $(\Cpos(x,y,c_0) \land \Cpos(x,y,c_1)) \Imp c_0 = c_1.$
  \end{block}
  \begin{itemize}
  \item
    $1$つのマスに塗れる色は$1$色までである．
  \end{itemize}
  \vfill
  \begin{block}{$\Cpaint$}
    $\forall x, y, i \in \N, \forall f:\N \to Color, Cpos(x+i,y,f(x+i))$.
  \end{block}
  \begin{itemize}
  \item
    最上段のマスは好きな塗り方ができる．
  \end{itemize}
  \begin{center}
    \input{four_steps2}
  \end{center}
\end{frame}

\section{証明の方針}

\begin{frame}
  \frametitle{証明の方針}
  \begin{block}{目標}
    $\forall k, n, x, y \in \N, n > 0 \Rightarrow$
    $(n = 3 ^ k \Leftrightarrow \forall c_0, c_1, c_2 \in \Color,\WCT(x,y,n,c_0,c_1,$ $c_2))$ 
  \end{block}
  \begin{itemize}
  \item
    十分条件
    \begin{itemize}
    \item
      $n = 3 ^ k \Rightarrow \WCT(x,y,n,c_0,c_1,$ $c_2)$
    \end{itemize}
    \vfill
  \item
    必要条件（対偶を場合分けして示す）
    \begin{itemize}
    \item
      $\redt{Even(n)} \Imp$ \\
      $\lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
    \item 
      $(\redt{Odd(n) \land 3^k < n \leq 3^k \cdot 2}) \Imp$ \\
      $ \lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
    \item 
      $(\redt{Odd(n) \land 3^k \cdot 2 + 1 \leq n < 3^{k+1}}) \Imp$ \\
      $\lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
    \end{itemize}
  \end{itemize}
\end{frame}


\section{十分条件の証明}
\begin{frame}
  \frametitle{十分条件の証明}
  \begin{block}{十分条件}
    $n = 3 ^ k \Rightarrow \WCT(x,y,n,c_0,c_1,$ $c_2)$
  \end{block}
  {\small
    \vfill
    \begin{center}
    \input{ind_steps}
    \end{center}
    $k$に関する数学的帰納法を用いて証明する．
    \begin{enumerate}
    \item
      帰納法の仮定より$3^k$段の三色三角形は調和彩色三角形．
    \item
      最上段の$4$色$c^0_0, c^{3^{k}}_0, c^{2\cdot3^{k}}_0, c^{3^{k+1}}_0$ と $mix$ を用いて最下段の色が得られる．
    \item
      $mix$ の性質より，最上段の$2$色 $c^0_0, c^{3^{k+1}}_0$ を用いて最下段の色が得られる．
    \item
      $3^{k+1}$段も調和彩色三角形であることが示せた．
    \end{enumerate}
  } 
\end{frame}

\section{必要条件の証明}

\begin{frame}
  \frametitle{必要条件の証明}
  \begin{block}{必要条件（ $n$ が偶数のとき ）}
    $\redt{Even(n)} \Imp$ \\
    $\lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
  \end{block}
  {\small
    \vfill
    \begin{center}
      \begin{tabular}{c}
        \input{even_steps2}
        \\
        $n=4$のとき
      \end{tabular}
    \end{center}
    \begin{enumerate}
    \item
      最上段の両端のマスからそれぞれ黄，青の順で対称的に交互に塗る.
    \item
      $1$段下において，マスはすべて赤で塗られる.
    \item
      最下段のマスは赤が塗られているので矛盾．
    \end{enumerate}
  } 
\end{frame}

\begin{frame}
  \frametitle{必要条件の証明}
  \begin{block}{必要条件（ $n$ が奇数 かつ $3^k < n \leq 3^k \cdot 2$ のとき）}
    $(\redt{Odd(n) \land 3^k < n \leq 3^k \cdot 2}) \Imp$ \\
    $ \lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
  \end{block}
  {\footnotesize
    \vfill
    \begin{center}
      \begin{tabular}{ccc}
        \input{shortodd_steps2}
        &
        \hfill
        &
        \input{shortodd_steps3}
        \\
        $n=5$ $(k=1)$ のとき
        &
        \hfill
        &
        $n=11$ $(k=2)$ のとき
      \end{tabular}
    \end{center}
    \begin{enumerate}
    \item
      最上段の両端のマスからそれぞれ黄，青の順で対称的に交互に塗る.
    \item
      $3^k$段下において，外側から黄，青の順で対称的に交互に塗られる.
    \item
      さらに，$1$段（最上段から$3^k + 1$段）下において，マスはすべて赤で塗られる.
    \item
      最下段のマスは赤が塗られているので矛盾．
    \end{enumerate}
  } 
\end{frame}

\begin{frame}
  \frametitle{必要条件の証明}
  \begin{block}{必要条件（ $n$ が奇数 かつ $3^k \cdot 2 + 1 \leq n < 3^{k+1}$ のとき）}
    $(\redt{Odd(n) \land 3^k \cdot 2 + 1 \leq n < 3^{k+1}}) \Imp$ \\
    $\lnot (\forall c \in Color, \forall f : \N \to Color, WCT(x,y,n,f(x),f(x+n),c))$
    \end{block}
  {\footnotesize
    \vfill
    \begin{center}
      \begin{tabular}{c}
        \input{longodd_steps2}
        \\
        $n=7$ $(k=1)$ のとき
      \end{tabular}
    \end{center}
    \begin{enumerate}
    \item
      最上段の両端のマスからそれぞれ$3^k$マス内を黄，その他を青で対称的に塗る.
    \item
      $3^k$段下において，外側から$ n - 2 \cdot 3^k + 1$ マスはすべて赤で塗られる.
    \item
      さらに，$3^k$段（最上段から$2 \cdot 3^k$段）下において，マスはすべて赤で塗られる.
    \item
      最下段のマスは赤が塗られているので矛盾．
    \end{enumerate}
  } 
\end{frame}

\section{まとめ}

\begin{frame}
  \frametitle{研究のまとめ}
  \begin{block}{研究の成果}
    $\forall k, n, x, y \in \N, n > 0 \Rightarrow$
    $(n = 3 ^ k \Leftrightarrow \forall c_0, c_1, c_2 \in \Color,\WCT(x,y,n,c_0,c_1,$ $c_2))$ \\
    を Coq で証明した．
  \end{block}
  \vfill
  \begin{alertblock}{問題であった点}
    \begin{itemize}
    \item
      幾何的な問題をどのようにして形式化するか
    \item
      暗黙のうちに仮定されてしまっていることを見落としやすい
    \end{itemize}
  \end{alertblock}
  \vfill
  \textbf{［解決法・工夫点］}
  \begin{itemize}
  \item
    三角形三色問題の暗黙の前提を明確化し，
    幾何的な状況を論理式で表現することで公理化した．
  \end{itemize}
\end{frame}

% 参考文献
\begin{frame}
  \frametitle{参考文献}
  \begin{thebibliography}{99}
  \bibitem{Coq}
    ``The Coq Proof Assistant'',
    https://coq.inria.fr/. 

  \bibitem{SSReflect}
    ``The SSReflect proof language'',
    \\
    https://coq.inria.fr/refman/proof-engine/ssreflect-proof-language.html. 
    
  \bibitem{CoqBook}
    萩原学, アフェルド・レナルド, 
    ``Coq/SSReflect/MathComp による定理証明'',
    森北出版,
    2018. 
    
  \bibitem{Nishiyama1}
    西山豊,
    ``エレガントな解答をもとむ 出題2''，
    数学セミナー,
    4月号, pp.87--91, 2013.
    
  \bibitem{Nishiyama2}
    西山豊,
    ``数学を楽しむ/三角形三色問題'',
    現代数学,
    Vol.47, No.10, pp.36--41, 2014.
    
  \bibitem{Nishiyama3}
    Y.~Nishiyama,
    ``THE THREE-COLOR TRIANGLE PROBLEM'', 
    International Journal of Pure and Applied Mathematics,
    Vol.85, No.1, pp.69--81, 2013.
  \end{thebibliography}
\end{frame}

\end{document}

%memo
%1ページずつ伝えることを決める．→事前に紙に設計図を書いておく．
%スライドの1枚目は背景や目的を書く．
%（専門用語は簡単な説明をのせておけばよい→詳しい話はスライドの後半に載せる）
%この次のページは研究成果やできると何が良いのかを書く．

%公理化したのは工夫ポイント．（重要）

%定義，公理や証明は論文の切り貼りでも大丈夫→ただし，スライドの冒頭の説明がより伝わるようにすること．
